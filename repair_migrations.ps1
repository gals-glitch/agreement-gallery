# Mark all old local migrations as applied on remote
# This allows us to push the new constraint migration

Write-Host "Marking old migrations as applied..." -ForegroundColor Cyan
Write-Host ""

$versions = @(
'20250907063338', '20250907063359', '20250907064138', '20250907065628', '20250907075744',
'20250917065023', '20250917065349', '20250921054208', '20250921054238', '20250921072409',
'20250921112315', '20250921113317', '20250921121035', '20250921121148', '20250921122717',
'20250921123341', '20250925111322', '20250925111404', '20250928071459', '20250928071530',
'20250930092547', '20250930092656', '20251005062805', '20251005080808', '20251005085309',
'20251005091911', '20251012100000', '20251012100001', '20251012100002', '20251012100003',
'20251012100004', '20251012100005', '20251012100006', '20251016000000', '20251016000001',
'20251016000002', '20251016000003', '20251016000004', '20251016000005', '20251016000006',
'20251016000007', '20251016000008', '20251016120000', '20251016170000', '20251019100001',
'20251019100002', '20251019100003', '20251019100004', '20251019100010', '20251019110000',
'20251019130000', '20251019140000', '20251020000001', '20251020000002', '20251021000000',
'20251021000100', '20251021000200', '20251022000001', '20251026000001', '20251105000000',
'20251105000001', '20251105000002', '20251105132840'
)

$cmd = "supabase migration repair $($versions -join ' ') --status applied --yes"

Write-Host "Running command:" -ForegroundColor Yellow
Write-Host $cmd -ForegroundColor White
Write-Host ""

Invoke-Expression $cmd
